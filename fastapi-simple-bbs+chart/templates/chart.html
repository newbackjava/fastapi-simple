{% extends "base.html" %}
{% block title %}{{ title }}{% endblock %}

{% block scripts %}
<script type="text/javascript">

axios.get('/chart/count').then(res => {
    <!-- alert(res.data.count) -->
    document.getElementById('count').innerHTML = "전체 회원수 : " + res.data.count + "명";
})

google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);
async function drawChart() {
    await axios.get('/chart/avg').then(res => {
             data = res.data.avg;
             console.log(data);
             total = []
             data_one = ['avg', 'Customers']
             total.push(data_one);

             for (x of data){
                 data_one = [String(x.customers), x.avg]
                 total.push(data_one);
             }
             var data = google.visualization.arrayToDataTable(total);

             var options = {
               title: 'Customers Avg'
             };

             var chart = new google.visualization.PieChart(document.getElementById('piechart'));

             chart.draw(data, options);
            })
}


      google.charts.load('current', {'packages':['gauge']});
      google.charts.setOnLoadCallback(drawChart2);

      async function drawChart2() {
            await axios.get('/chart/all').then(res => {
                     data2 = res.data.all;
                     console.log(data2);
                     total2 = []
                     data_one2 = ['customers', 'revenue']
                     total2.push(data_one2);
                     console.log(total2);
                     for (x of data2){
                         data_one2 = [String(x.customers), x.revenue]
                         console.log(data_one2);
                         total2.push(data_one2)
                     }
                    var data2 = google.visualization.arrayToDataTable(total2);

                    var options2 = {
                      width: 900, height: 600,
                      redFrom: 90, redTo: 100,
                      yellowFrom:75, yellowTo: 90,
                      minorTicks: 5
                    };

                    var chart2 = new google.visualization.Gauge(document.getElementById('chart_div'));

                    chart2.draw(data2, options2);

                    setInterval(function() {
                      data2.setValue(0, 1, 40 + Math.round(60 * Math.random()));
                      chart2.draw(data2, options2);
                    }, 13000);
                    setInterval(function() {
                      data2.setValue(1, 1, 40 + Math.round(60 * Math.random()));
                      chart2.draw(data2, options2);
                    }, 5000);
                    setInterval(function() {
                      data2.setValue(2, 1, 60 + Math.round(20 * Math.random()));
                      chart2.draw(data2, options2);
                    }, 26000);

        })
}
</script>
{% endblock %}

{% block content %}
<h1 id="count" style="margin-bottom:16px;"></h1>
<div id="piechart" style="width: 900px; height: 500px;"></div>
<div id="chart_div"></div>
{% endblock %}